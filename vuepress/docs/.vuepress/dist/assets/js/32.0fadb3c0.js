(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{315:function(s,a,n){"use strict";n.r(a);var e=n(6),t=Object(e.a)({},function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"redis"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#redis","aria-hidden":"true"}},[s._v("#")]),s._v(" Redis")]),s._v(" "),n("h2",{attrs:{id:"安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装","aria-hidden":"true"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令安装redis：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" redis-server\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改密码：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/redis/redis.conf\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消注释：requirepass foobared，修改密码： requirepass 你的密码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 远程访问：添加注释 bind 127.0.0.1 ::1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启: service redis restart")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止: service redis stop")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 源码安装")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.redis.io/releases/redis-4.0.14.tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xzf redis-4.0.14.tar.gz\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" redis-4.0.14\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("安装完成后，在redis-4.0.14安装目录下会出现一个bin目录，bin目录下有几个可执行文件")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 性能测试工具")]),s._v("\nredis-benchmark\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# AOF文件修复工具")]),s._v("\nredis-check-aof\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# RDB文件检测工具（快照持久化文件）")]),s._v("\nredis-check-rdb\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令行客户端")]),s._v("\nredis-cli\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis哨兵")]),s._v("\nredis-sentinel -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" redis-server\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis服务器启动命令")]),s._v("\nredis-server\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h2",{attrs:{id:"配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 配置文件")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis缓存")]),s._v("\nspring.cache.type"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Redis\nspring.redis.database"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("2\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("单点")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Redis服务器地址")]),s._v("\nspring.redis.host"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("127.0.0.1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Redis服务器连接端口")]),s._v("\nspring.redis.port"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("6379\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Redis服务器连接密码（默认为空）")]),s._v("\nspring.redis.password"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 连接池最大连接数（使用负值表示没有限制）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#spring.redis.pool.max-active=8")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 连接池最大阻塞等待时间（使用负值表示没有限制）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#spring.redis.pool.max-wait=-1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 连接池中的最大空闲连接")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#spring.redis.pool.max-idle=8")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 连接池中的最小空闲连接")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#spring.redis.pool.min-idle=0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 连接超时时间（毫秒）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#spring.redis.timeout=0")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("集群")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#逗号分隔")]),s._v("\nspring.redis.cluster.nodes"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("192.168.0.159:7001,192.168.0.159:7002\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"redis集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#redis集群","aria-hidden":"true"}},[s._v("#")]),s._v(" Redis集群")]),s._v(" "),n("h2",{attrs:{id:"说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#说明","aria-hidden":"true"}},[s._v("#")]),s._v(" 说明")]),s._v(" "),n("ul",[n("li",[s._v("redis支持集群最小的单位为6个实例，3个主节点，3个从节点")]),s._v(" "),n("li",[s._v("假设两台机器：192.168.0.1， 192.168.0.2, 每台机器安装3个结点")]),s._v(" "),n("li",[s._v("redis使用源码安装方式，安装目录redis-4.0.14")])]),s._v(" "),n("h2",{attrs:{id:"配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置","aria-hidden":"true"}},[s._v("#")]),s._v(" 配置")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 192.168.0.1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" redis-4.0.14\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" redis_cluster\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" redis_cluster\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" 7000 7001 7002\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在文件夹 7000/7001/7002中分别创建文件redis.conf")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("其中，7000/redis.conf文件如下，7001和7002中redis.conf文件请修改相应端口")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis后台运行")]),s._v("\ndaemonize "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pidfile文件对应7000,7002,7003")]),s._v("\npidfile /var/run/redis_7000.pid\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据文件存放位置对应7000,7001,7002,7003,7004,7005")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v(" /var/run/redis_cluster/7000/\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认ip为127.0.0.1 需要改为其他节点机器可访问的ip 否则创建集群时无法访问对应的端口，无法创建集群  ")]),s._v("\nbind 192.168.0.1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 端口7000,7002,7003")]),s._v("\nport 7000\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启集群")]),s._v("\ncluster-enabled  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 集群的配置, 配置文件首次启动自动生成")]),s._v("\ncluster-config-file nodes.conf\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 请求超时, 设置5秒够了")]),s._v("\ncluster-node-timeout 5000\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# aof日志开启, 有需要就开启, 它会每次写操作都记录一条日志")]),s._v("\nappendonly "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[s._v("在 192.168.0.2 机器上重复上述步骤，然后分别在2台服务器上启动redis")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" redis-4.0.14\n./bin/redis-server redis_cluster/7000/redis.conf\n./bin/redis-server redis_cluster/7001/redis.conf\n./bin/redis-server redis_cluster/7002/redis.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("测试服务是否正常启动")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看服务是否正常运行")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" redis\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试客户端是否可正常连接")]),s._v("\n./bin/redis-cli -h 192.168.0.1 -p 7000\n192.168.0.1:7000"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\nPONG\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止redis运行")]),s._v("\n./bin/redis-cli -h 192.168.0.1 -p 7000 "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h2",{attrs:{id:"创建集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建集群","aria-hidden":"true"}},[s._v("#")]),s._v(" 创建集群")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis安装目录src中redis-trib.rb完成集群创建，redis-trib.rb命令需要安装gem redis模块才能运行，gem redis需要Ruby环境")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装ruby")]),s._v("\nyum -y "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ruby ruby-devel rubygems rpm-build\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gem 这个命令来安装 redis接口")]),s._v("\ngem "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" redis\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" redis-4.0.14\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建新集群命令：命令create")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --replicas 1 表示 自动为每一个master节点分配一个slave节点. 上面有6个节点，程序会按照一定规则生成 3个master（主）3个slave(从)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 其他参数用于创建新集群的实例的地址列表")]),s._v("\n./src/redis-trib.rb create --replicas 1 192.168.0.1:7000 192.168.0.1:7001 192.168.0.1:7002 192.168.0.2:7000 192.168.0.2:7001 192.168.0.2:7002\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测试","aria-hidden":"true"}},[s._v("#")]),s._v(" 测试")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 集群客户端连接方式 redis-cli  -c")]),s._v("\n./bin/redis-cli -c -h 192.168.0.1 -p 7000\n192.168.0.1:7000"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" foo bar\n-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Redirected to slot "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("12182"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" located at 192.168.0.1:7002\nOK\n192.168.0.1:7002"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" get foo\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bar"')]),s._v("\n192.168.0.1:7002"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" keys *\n1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"foo"')]),s._v("\n192.168.0.1:7002"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exit")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node21 redis-cluster"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis-cli -c -h 192.168.0.1 -p 7000")]),s._v("\n192.168.0.1:7000"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" keys *\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("empty list or set"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n192.168.0.1:7000"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" get foo\n-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Redirected to slot "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("12182"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" located at 192.168.0.1:7002\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bar"')]),s._v("\n192.168.0.1:7002"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h2",{attrs:{id:"其他常用命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#其他常用命令","aria-hidden":"true"}},[s._v("#")]),s._v(" 其他常用命令")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看集群情况")]),s._v("\n其中，ip代表服务器地址，port为服务器端口号\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查集群状态")]),s._v("\nredis-trib.rb check ip:port\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用-c进入集群命令模式")]),s._v("\nredis-cli -c -h ip -p port\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新分配权重")]),s._v("\nredis-trib.rb rebalance ip:port --auto-weights\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用add-node命令将新节点的地址指定为第一个参数，并将集群中随机存在节点的地址指定为第二个参数，redis-trib在运行之前也会检查集群的状态。")]),s._v("\nredis-trib.rb add-node ip:port（新增节点） ip:port（现有效节点）\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除master节点之前首先要使用reshard移除master的全部slot")]),s._v("\nredis-trib.rb del-node ip:port id（目标节点的id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新划分slot")]),s._v("\nredis-trib.rb reshard ip:port\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将master转换为salve")]),s._v("\ncluster replicate master-id "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 转换前6380端必须没有slots")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h3",{attrs:{id:"微信公众号"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#微信公众号","aria-hidden":"true"}},[s._v("#")]),s._v(" 微信公众号")]),s._v(" "),n("img",{staticStyle:{width:"250px"},attrs:{src:s.$withBase("/image/qrcode_xiaperio_430.jpg")}}),s._v(" "),n("h2",{attrs:{id:"参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考","aria-hidden":"true"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/erikdubbelboer/phpRedisAdmin",target:"_blank",rel:"noopener noreferrer"}},[s._v("phpRedisAdmin"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.daxiblog.com/redis%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7redisdesktopmanager-0-9-9-%E5%AE%89%E8%A3%85%E5%8C%85%E4%B8%8B%E8%BD%BD/",target:"_blank",rel:"noopener noreferrer"}},[s._v("RedisDesktopManager Windows"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/onewe/RedisDesktopManager-Mac/releases/tag/0.9.9",target:"_blank",rel:"noopener noreferrer"}},[s._v("RedisDesktopManager Mac"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://redis.io/topics/cluster-tutorial",target:"_blank",rel:"noopener noreferrer"}},[s._v("Redis cluster tutorial"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.jianshu.com/p/c8a957413284",target:"_blank",rel:"noopener noreferrer"}},[s._v("redis 4.0 集群部署"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/frankdeng/p/9332618.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("CentOS7安装Redis4.0.10与集群搭建"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://www.liutf.com/posts/1419646468.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("CentOS6.5搭建Redis-v4.0.8集群"),n("OutboundLink")],1)])])])},[],!1,null,null,null);a.default=t.exports}}]);