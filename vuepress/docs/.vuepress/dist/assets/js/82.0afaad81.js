(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{367:function(s,e,a){"use strict";a.r(e);var t=a(6),n=Object(t.a)({},function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"letsencrypt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#letsencrypt","aria-hidden":"true"}},[s._v("#")]),s._v(" Letsencrypt")]),s._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("支持https")])]),s._v(" "),a("h2",{attrs:{id:"安装acme-sh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装acme-sh","aria-hidden":"true"}},[s._v("#")]),s._v(" 安装acme.sh")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v("  https://get.acme.sh "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" sh\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("source")]),s._v(" ~/.bashrc\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" socat\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"生成证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生成证书","aria-hidden":"true"}},[s._v("#")]),s._v(" 生成证书")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 首先停止nginx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx stop\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果有设置cdn的话，在阿里云域名后台暂停www/cdn解析，否则忽略")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将域名解析到此服务器ip地址")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 初次生成(二级域名可自行增加或删除)：")]),s._v("\nacme.sh --issue -d example.com -d www.example.com -d vip.example.com -d wechat.example.com -d oauth.example.com -d api.example.com -d upload.example.com -d support.example.com -d stomp.example.com -d export.example.com -d cdn.example.com -d mini.example.com --standalone\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 后续更新")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# acme.sh --renew -d example.com -d www.example.com -d vip.example.com -d wechat.example.com -d oauth.example.com -d api.example.com -d upload.example.com -d support.example.com -d stomp.example.com -d export.example.com -d cdn.example.com -d mini.example.com --standalone --force -w /var/www/html")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"安装证书"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装证书","aria-hidden":"true"}},[s._v("#")]),s._v(" 安装证书")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建文件夹")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" /etc/nginx\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" ssl\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装上述到文件夹")]),s._v("\nacme.sh --installcert -d example.com --key-file /etc/nginx/ssl/example.key --fullchain-file /etc/nginx/ssl/fullchain.cer\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不管多域名证书里有几个域名，这里的 -d 参数只需要带第一个域名即可")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改/etc/nginx/sites-available/default添加：")]),s._v("\nssl_certificate /etc/nginx/ssl/fullchain.cer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nssl_certificate_key /etc/nginx/ssl/example.key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动nginx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx start\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启nginx:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl restart nginx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新加载：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service nginx force-reload")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# acme自动升级：")]),s._v("\nacme.sh  --upgrade  --auto-upgrade\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# [Sat Aug 15 06:42:06 CST 2020] Your cert is in  /root/.acme.sh/example.com/example.com.cer")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# [Sat Aug 15 06:42:06 CST 2020] Your cert key is in  /root/.acme.sh/example.com/example.com.key")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# [Sat Aug 15 06:42:06 CST 2020] The intermediate CA cert is in  /root/.acme.sh/example.com/ca.cer")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# [Sat Aug 15 06:42:06 CST 2020] And the full chain certs is there:  /root/.acme.sh/example.com/fullchain.cer")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 清除浏览器缓存之后，然后刷新网页，查看证书日期")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考","aria-hidden":"true"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/Neilpang/acme.sh/wiki/%E8%AF%B4%E6%98%8E",target:"_blank",rel:"noopener noreferrer"}},[s._v("说明"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://segmentfault.com/a/1190000018244767",target:"_blank",rel:"noopener noreferrer"}},[s._v("其他"),a("OutboundLink")],1)])])])},[],!1,null,null,null);e.default=n.exports}}]);